"use strict";StackExchange.ready(function(){function t(){var t=d.data("validation-errors"),n=d.data("validation-warnings");(t||n)&&StackExchange.postValidation.showErrorsAfterSubmission(d,c,"question",t,n)}function n(t,n,e){y&&StackExchange.using("gps",function(){StackExchange.gps.track(t,n,e),e&&E.trigger()})}function e(t,e,a){a.forEach(function(a){t.one(a,function(){n("question.action",{"action_type":e+"_"+a},!0)})})}function a(t,n){try{q||(S.removeClass("dno"),StackExchange.editor.finallyInit(),q=!0,d.data("delay-validation")||StackExchange.using("postValidation",function(){StackExchange.postValidation.initOnBlur(S,u,"post",!1)})),j.fadeTo(t?0:400,1,n)}catch(e){setTimeout(function(){a(t,n)},10)}}function o(){var t=C.find('[data-kp="'+(StackExchange.options.site.routePrefix||"")+'"]').index();C.prop("selectedIndex",t)}function i(t){var n=[],e=function(t){for(var e=0,a=t;e<a.length;e++){var o=a[e];-1===n.indexOf(o)&&n.push(o)}};return e(t.Title),e(t.Body),e(t.Tags),n}function s(){P||(P=$('<input name="distinctErrorCount" type="hidden">').appendTo(d),I=$('<input name="distinctWarningCount" type="hidden">').appendTo(d),B=$('<input name="unresolvedWarningCount" type="hidden">').appendTo(d));var t=O.namedWarnings.map(function(t){return t.bodies});O.unnamedWarnings&&t.push(O.unnamedWarnings),P.val(O.distinctErrorCount),I.val(t.length),B.val(t.filter(function(t){return i(t).length>0}).length)}function r(){function t(t,e){var a=i(e),r=a.length>0,c=$("<div>").html(n.find(".js-warning-template").text());c.find(".js-guidance-title").text(t),c.find(".js-separator").toggleClass("d-none",s.is(":empty")),c.find(".js-success-icon").toggleClass("d-none",r),c.find(".js-warning-icon").toggleClass("d-none",!r);var u=c.find(".js-guidance-body").toggleClass("d-none",!r);if(r){o=!1;for(var d=0,l=a;d<l.length;d++){var f=l[d];$('<div class="grid--cell" />').html(f).appendTo(u)}}u.find("a").attr("target","_blank"),c.children().appendTo(s)}var n=$(".js-post-review-summary");if(0!==n.length&&O.loaded.Title&&O.loaded.Body&&O.loaded.Tags){var e=O.errors.Title+O.errors.Body+O.errors.Tags,a=!!O.unnamedWarnings||O.namedWarnings.length>0;n.find(".js-loading-message").addClass("d-none"),n.find(".js-success-no-warnings").toggleClass("d-none",e>0||a),n.find(".js-error-container").toggleClass("d-none",0===e),n.find(".js-warning-and-error-separator").toggleClass("d-none",0===e||!a),n.find(".js-warning-container").toggleClass("d-none",!a),e>0&&n.find(".js-error-message").text(function(t){return 1==t.__count,"Resolve "+t.__count+" issues before posting"}({"__count":e}));for(var o=0===e,s=n.find(".js-warning-list").empty(),r=0,c=O.namedWarnings;r<c.length;r++){var u=c[r];t(u.name,u.bodies)}O.unnamedWarnings&&t("Other suggestions",O.unnamedWarnings),n.find(".js-resolved-warnings-message").toggleClass("d-none",!o),n.find(".js-unresolved-warnings-message").toggleClass("d-none",o)}}StackExchange.helpers.removeParameterFromQueryString("fromen");var c=1,u=2,d=$(".js-post-form"),l=d.find(".js-post-title-field"),f=d.find(".js-post-body-field[data-post-type-id="+c+"]"),g=d.find(".js-post-tags-field"),p=d.find(".js-post-body-field[data-post-type-id="+u+"]"),h=d.find(".js-similar-questions");d.data("delay-validation")||StackExchange.using("postValidation",function(){d.data("has-answer")||t(),StackExchange.postValidation.initOnBlurAndSubmit(d,c,"question",!1)});var v={"siteName":document.title.substr(document.title.indexOf(" - ")+3),"onResults":function(t){null!==t&&y&&(n("question_ask.suggestions_show",{}),StackExchange.using("gps",function(){t.addClass("js-gps-track").data("gps-track","question_ask.suggestion_click similarquestions.title_link_clicked"),StackExchange.gps.bindTrackClicks(h)})),d.data("is-wizard")&&StackExchange.using("wizardEditor",function(){StackExchange.wizardEditor.onTitleSearchResults(null!==t)})}};StackExchange.question.initTitleSearch(l,h,v);var b=$(".js-ask-public"),m=$(".js-submit-button");b.change(function(){var t=this.checked;b.prop("checked",t),m.prop("disabled",!t)}),$(".js-tag-suggestions").length>0&&StackExchange.using("tagSuggestions",function(){StackExchange.tagSuggestions.init()});var k=d.data("required-tags");k&&StackExchange.using("tagEditor",function(){StackExchange.tagEditor.requiredTags=k});var w=d.data("force-heartbeat-at-body-length");w&&StackExchange.using("editor",function(){var t=setInterval(function(){f.val().length>=w&&(clearInterval(t),StackExchange.cardiologist.beatASAP())},3e3)});var y=d.data("enable-analytics"),x=d.data("enable-warning-analytics"),E=StackExchange.helpers.DelayedReaction(function(){return StackExchange.gps.sendPending()},3e3);n("question_ask.visit",{"inbox_subscription":d.data("inbox-subscription"),"referrer":d.data("referrer")}),e(l,"title",["blur"]),e(f,"body",["focus","blur"]),e(g,"tags",["focus","blur"]);var _=$(".js-post-answer-while-asking-checkbox"),q=!1,S=$("#question-answer-section"),T=$(".js-show-on-question-only"),j=$(".js-show-on-question-and-answer");_.change(function(){var t=_.get(0);t.disabled=!0,_.is(":checked")?T.fadeOut(function(){a(!1,function(){p.focus(),t.disabled=!1})}):j.fadeOut(function(){T.fadeIn(function(){t.disabled=!1})})}),(_.is(":checked")||d.data("has-answer"))&&(_.attr("checked","checked"),T.hide(),StackExchange.using("editor",function(){setTimeout(function(){a(!0,t)},2)}));var C=$("#inline-channel-switcher");C.length>0&&($(window).on("load",o),C.off("change"),C.on("change",function(){var t=C.val();if(t&&t.length){var n=l.val().length>0||f.val().length>0||p.val().length>0;if(n){var e=StackExchange.options.user.fkey,a=e.lastIndexOf("/");a>=0&&(e=e.substr(a+1));var i=C.find(":selected").data("kp");i&&i.length&&(e=i+"/"+e);var s=$('#post-form input[name="fkey"]'),r=s.val();s.val(e);var c=$("#post-form").serialize();s.val(r),$.ajax({"url":t+"/save-draft","type":"POST","data":c,"success":function(){window.onbeforeunload=null,$.post("/post/discard-draft",{"fkey":StackExchange.options.user.fkey,"postType":"ask"}),window.location=t},"error":function(){o();var t={"position":{"my":"left top","at":"right center"},"css":{"width":"200px"}};StackExchange.helpers.showErrorMessage($("#inline-channel-switcher"),"An error occurred. Please try again later.",t)},"doNotRewriteUrl":!0})}else window.location=t}return!1}));var W=$(".js-begin-review-button");W.click(function(){W.addClass("is-loading"),StackExchange.cardiologist.ensureDraftSaved(function(){},!0),StackExchange.postValidation.validatePostFields(d,c,"question",!1,function(){return $(".js-visible-before-review").fadeOut().promise()}).then(function(){d.data("delay-validation",!1),StackExchange.postValidation.initOnBlurAndSubmit(d,c,"question",!1),_.is(":checked")&&(StackExchange.postValidation.initOnBlur(S,u,"post",!1),StackExchange.postValidation.validatePostFields(S,u,"post",!1))}).then(function(){$(".js-visible-during-review").removeClass("d-none").hide().fadeIn(),StackExchange.postValidation.scrollToErrors()}).fail(function(){W.removeClass("is-loading")})});var O={"loaded":{"Title":!1,"Body":!1,"Tags":!1},"errors":{"Title":0,"Body":0,"Tags":0},"namedWarnings":[],"observedErrors":{},"distinctErrorCount":0};d.on("post:validated-field",function(t,e,a,o,i){if("question"===e&&("Title"===a||"Body"===a||"Tags"===a)){O.loaded[a]=!0,O.errors[a]=o.length,o.forEach(function(t){O.observedErrors[t]||(O.observedErrors[t]=!0,O.distinctErrorCount+=1)});var c={},u=[];i.forEach(function(t){var n=$("<div>").html(t),e=n.get(0).childNodes;if(e.length<3||"B"!==e[0].nodeName||"BR"!==e[1].nodeName||$(e[0]).children().length>0)return u.push(t),void 0;for(var a=$(e[0]).remove().text();n.children().first().is("br");)n.children().first().remove();var o=$.trim(n.html());return 0===o.length?(u.push(t),void 0):(c[a]||(c[a]=[]),c[a].push(o),void 0)}),O.namedWarnings.forEach(function(t){t.bodies[a]=c[t.name]||[],delete c[t.name]});for(var d in c){var l={"name":d,"bodies":{"Title":[],"Body":[],"Tags":[]}};l.bodies[a]=c[d],O.namedWarnings.push(l),x&&n("question_ask.warning_show",{"name":d},!0)}(O.unnamedWarnings||u.length>0)&&(O.unnamedWarnings||(O.unnamedWarnings={"Title":[],"Body":[],"Tags":[]},x&&n("question_ask.warning_show",{},!0)),O.unnamedWarnings[a]=u),s(),r()}}),d.on("post:submit-completed",function(t,e,a){a.success&&y&&x&&StackExchange.gps&&(O.namedWarnings.forEach(function(t){n("question_ask.warning_resolution",{"name":t.name,"resolved":0===i(t.bodies).length},!0)}),O.unnamedWarnings&&n("question_ask.warning_resolution",{"resolved":0===i(O.unnamedWarnings).length},!0))});var P,I,B});